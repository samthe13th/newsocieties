<app-tabs 
  *ngIf="tabs"
  selectedClass="central-selected-tab"
  [tabs]="tabs">
</app-tabs>

<div *ngIf="showModal === true" class="modal-wrap">
  <div class="modal">
    <ng-container *ngTemplateOutlet="modalContent"></ng-container>
  </div>
</div>

<ng-template #sceneriosPreview>
  <div class="button-row">
    <button (click)="cancelUpdate('scenerios')">Cancel</button>
    <button (click)="updateVoteData('scenerios')">Update</button>
  </div>
  <table *ngIf="voteData?.scenerios" style="width: 100%">
    <tr>
      <th>Pre-vote</th>
      <th>Post-vote</th>
    </tr>
    <tr *ngFor="let scenerio of voteData.scenerios">
      <td>
        <div><strong>{{ scenerio.title }}</strong></div>
        <div>{{ scenerio.prompt }}</div>
        <ul style="margin-top: 0">
          <ng-container *ngFor="let option of scenerio.options">
            <li *ngIf="option?.prompt">
              {{option?.prompt}}
            </li>
          </ng-container>
        </ul>
      </td>

      <td>
        <div><strong>{{ scenerio.title }}</strong></div>
        <div>{{ scenerio.result }}</div>
        <ul style="margin-top: 0">
          <ng-container *ngFor="let option of scenerio.options">
            <li *ngIf="option?.result">
              {{option?.result}}
            </li>
          </ng-container>
        </ul>
      </td>

    </tr>
  </table>
</ng-template>

<ng-template #principlesPreview>
  <div class="button-row">
    <button (click)="cancelUpdate('principles')">Cancel</button>
    <button (click)="updateVoteData('principles')">Update</button>
  </div>
  <div *ngIf="voteData?.principles" class="flex-column">
    <ng-container *ngFor="let principle of voteData.principles">
      <strong>{{principle.title}}</strong>
      <div>{{principle.prompt}}</div>
      <ul style="margin-top: 0">
        <ng-container *ngFor="let option of principle.options">
          <li *ngIf="option">{{option.result}}</li>
        </ng-container>
      </ul>
    </ng-container>
  </div>
</ng-template>

<ng-template #resolutionsPreview>
  <div class="button-row">
    <button (click)="cancelUpdate('resolutions')">Cancel</button>
    <button (click)="updateVoteData('resolutions')">Update</button>
  </div>
  <table *ngIf="voteData?.resolutions" style="width: 100%">
    <tr>
      <th>Pre-vote</th>
      <th>Post-vote</th>
    </tr>
    <tr *ngFor="let resolution of voteData.resolutions">

      <td>
        <strong>{{ resolution.title }}</strong>
        <div>{{ resolution.prompt }}</div>
        <ul style="margin-top: 0">
          <ng-container *ngFor="let option of resolution.options">
            <li *ngIf="option?.prompt">
              {{option?.prompt}}({{option?.cost}})
            </li>
          </ng-container>
        </ul>
      </td>

      <td>
        <strong>{{ resolution.title }}</strong>
        <div>{{ resolution.result }}</div>
        <ul style="margin-top: 0">
          <ng-container *ngFor="let option of resolution.options">
            <li *ngIf="option?.result">
              {{option?.result}}({{option?.consequence}})
            </li>
          </ng-container>
        </ul>
      </td>

    </tr>
  </table>
</ng-template>

<ng-template #show>Show</ng-template>
<ng-template #summary>Summary</ng-template>

<ng-template #showBody>
  <button (click)="wipeShows()">Wipe Shows</button>
  <button (click)="newShow()">New Show</button>
  localhost:4200/{{showKey}}

  <div class="vote-data">
    Principles
    <input [(ngModel)]="voteFileValues.principles" (change)="uploadPrinciplesData($event)" type="file" #fileUpload/>
  </div>

  <div class="vote-data">
    Resolutions
    <input [(ngModel)]="voteFileValues.resolutions" (change)="uploadResolutionsData($event)" type="file" #fileUpload/>
  </div>

  <div class="vote-data">
    Scenerios
    <input [(ngModel)]="voteFileValues.scenerios" (change)="uploadSceneriosData($event)" type="file" #fileUpload/>
  </div>

</ng-template>

<ng-template #summaryBody>
  <app-society-grid *ngIf="showKey" [showKey]="showKey"></app-society-grid>
</ng-template>

<ng-container *ngFor="let div of divisions">
  <ng-template #tab>{{div}}</ng-template>
  <ng-template #division>
    <div class="central__division">
      <div class="central__division-chat">
        <!-- <div class="test-class"></div> -->
        <!-- <div class="test-class-2"></div> -->
        <app-chat 
          [showKey]="showKey"
          [feedName]="div"
          sender='central'
        >
        </app-chat>
        <div class="central__division-chat-controls">
          <div class="flex-column stretch-h">
            <textarea
              (keydown.enter)="submitChat(div)"
              class="central__division-chat-input"
              name="chatInput"
              type="text"
              [(ngModel)]="chatInput">
            </textarea>
          </div>
          <div class="central__division-chat-buttons">
            <div class="button-row">
              <button 
                (click)="sendEvent(div)"
                class="central__division-chat-button icon">
                E
              </button>
              <button
                (click)="sendBroacastNotification(div)"
                class="central__division-chat-button icon">
                B
              </button>
            </div>
            <button 
              class="central__division-chat-button primary"
              (click)="submitChat(div)">
              SEND
            </button>
          </div>
        </div>
      </div>
      <div class="central__division-main">
        {{div.code}}
      </div>
    </div>
  </ng-template>
</ng-container>